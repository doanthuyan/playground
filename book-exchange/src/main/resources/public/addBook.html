
<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
    <script src="http://malsup.github.com/jquery.form.js"></script>
	<script type="text/javascript" language="javascript">

function saveBook()
{
    document.getElementById("imageForm").submit();
    URL = "/api/book/add";
	
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange  = function(){
		var txt ="<h2>";
		console.log(this.responseText );
		if (this.readyState == 4) {
			if(this.responseText == "true"){
			txt += "Book Saved!";
			}else{
			
				txt += "Book cannot save. Please check data!";
			}
			txt += "</h2>";
			document.getElementById("statusDiv").innerHTML = txt;

		}
	};
    //xmlhttp.open("POST", URL, false);
    //xmlhttp.setRequestHeader("Content-Type", "application/json");
    //xmlhttp.onreadystatechange = callbackFunction(xmlhttp);
    //xmlhttp.send();
    //alert(xmlhttp.responseText);
    //document.getElementById("demo").innerHTML = '<code>' +xmlhttp.responseText +'</code>';
	//console.log(xmlhttp.responseText.resultStatus);
	var queryString = $('#bookForm').formSerialize();
	console.log(queryString);
	xmlhttp.open("POST", URL, true);
	xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xmlhttp.send(queryString);
      
}
function loadFile(event) {
    var output = document.getElementById('output');
    output.src = URL.createObjectURL(event.target.files[0]);
	document.getElementById('imageLink').value = event.target.files[0].name;
  }
</script>
</head>
<h1>Add a book</h1>
<div id="statusDiv"></div>
<form method="POST" id="bookForm">
  Title:<br>
  <input type="text" name="title" value="Mickey" >
  <br>
  Author:<br>
  <input type="text" name="author" value="Mouse">
  <br>
  Pages:<br>
  <input type="number" name="pages" value="2019">
  <br>
  Language:<br>
  <input type="text" name="language" value="Mouse">
  <br>
  Year:<br>
  <input type="number" name="year" value="2019">
  <br>
  Amount in stock:<br>
  <input type="number" name="amountInStock" value="1">
  <br>
  Country:<br>
  <input type="text" name="country" value="Mouse">
  <br>
  Link:<br>
  <input type="text" name="link" value="Mouse">
  <br>
  Cover image:<br>
  <input type="text" name="imageLink" id="imageLink" value="Mouse" readonly>
  <br>
</form> 
<form id="imageForm" method="post" action="/upload" enctype="multipart/form-data">
<input type="file" accept="image/*" name="file" onchange="loadFile(event)">
<img id="output"/>
</form>
  <br>
  <input type="button" value="Create" onclick="javascript:saveBook()">

<html>